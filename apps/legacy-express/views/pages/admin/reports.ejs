<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/admin-dashboard.css">
</head>
<body>
  <div class="admin-container">
    <aside class="admin-sidebar">
      <div class="admin-logo"><h2>Admin Panel</h2></div>
      <nav class="admin-nav">
        <ul>
          <li class="nav-item"><a href="/admin" class="nav-link">ðŸ“Š Dashboard</a></li>
          <li class="nav-item"><a href="/admin/appointments" class="nav-link">ðŸ“… Appointments</a></li>
          <li class="nav-item"><a href="/admin/customers" class="nav-link">ðŸ‘¥ Customers</a></li>
          <li class="nav-item"><a href="/admin/staff" class="nav-link">ðŸ‘” Staff</a></li>
          <li class="nav-item"><a href="/admin/services" class="nav-link">ðŸ’‡ Services</a></li>
          <li class="nav-item active"><a href="/admin/reports" class="nav-link">ðŸ“ˆ Reports</a></li>
        </ul>
      </nav>
      <div class="admin-user-info">
        <div class="user-avatar"><%= user.givenName.charAt(0) %></div>
        <div class="user-details">
          <p class="user-name"><%= user.givenName %> <%= user.familyName %></p>
        </div>
      </div>
    </aside>

    <main class="admin-main">
      <div class="admin-topbar">
        <h1 class="page-title"><%= title %></h1>
        <div class="topbar-actions">
          <a href="/auth/logout" class="btn btn-logout">Logout</a>
        </div>
      </div>

      <div class="admin-content">
        <!-- Stats Grid -->
        <div class="dashboard-grid">
          <div class="stat-card highlight">
            <div class="stat-header">
              <h3>Total Revenue</h3>
              <span class="stat-icon">ðŸ’µ</span>
            </div>
            <div class="stat-body">
              <div class="stat-value"><%= formatCurrency(revenueStats.totalRevenue * 100) %></div>
              <div class="stat-subtext">From <%= revenueStats.completedCount %> completed services</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <h3>Total Appointments</h3>
              <span class="stat-icon">ðŸ“…</span>
            </div>
            <div class="stat-body">
              <div class="stat-value"><%= appointmentStats.total %></div>
              <div class="stat-subtext">Appointments today</div>
            </div>
            <div class="stat-details">
              <div class="detail">
                <span class="detail-label">Completed:</span>
                <span class="detail-value"><%= appointmentStats.completed %></span>
              </div>
              <div class="detail">
                <span class="detail-label">Cancelled:</span>
                <span class="detail-value"><%= appointmentStats.cancelled %></span>
              </div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <h3>Customer Base</h3>
              <span class="stat-icon">ðŸ‘¥</span>
            </div>
            <div class="stat-body">
              <div class="stat-value"><%= customerStats.total %></div>
              <div class="stat-subtext">Total customers</div>
            </div>
            <div class="stat-details">
              <div class="detail">
                <span class="detail-label">With contact:</span>
                <span class="detail-value"><%= customerStats.withPhone + customerStats.withEmail %></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Performance Metrics -->
        <div class="section">
          <h2>Performance Metrics</h2>
          <div class="metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div style="padding: 15px; background: var(--light-bg); border-radius: 6px;">
              <div style="font-size: 12px; color: #7f8c8d; text-transform: uppercase;">Completion Rate</div>
              <div style="font-size: 24px; font-weight: bold; margin-top: 10px;">
                <% const rate = appointmentStats.total > 0 ? Math.round((appointmentStats.completed / appointmentStats.total) * 100) : 0 %>
                <%= rate %>%
              </div>
            </div>
            <div style="padding: 15px; background: var(--light-bg); border-radius: 6px;">
              <div style="font-size: 12px; color: #7f8c8d; text-transform: uppercase;">Cancellation Rate</div>
              <div style="font-size: 24px; font-weight: bold; margin-top: 10px;">
                <% const cancelRate = appointmentStats.total > 0 ? Math.round((appointmentStats.cancelled / appointmentStats.total) * 100) : 0 %>
                <%= cancelRate %>%
              </div>
            </div>
            <div style="padding: 15px; background: var(--light-bg); border-radius: 6px;">
              <div style="font-size: 12px; color: #7f8c8d; text-transform: uppercase;">Avg Revenue per Service</div>
              <div style="font-size: 24px; font-weight: bold; margin-top: 10px;">
                <%= formatCurrency(revenueStats.averageValue * 100) %>
              </div>
            </div>
          </div>
        </div>

        <!-- Export Section -->
        <div class="section">
          <h2>Export Reports</h2>
          <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <button class="btn btn-primary" onclick="exportReport('daily')">ðŸ“Š Daily Report</button>
            <button class="btn btn-primary" onclick="exportReport('weekly')">ðŸ“ˆ Weekly Report</button>
            <button class="btn btn-primary" onclick="exportReport('monthly')">ðŸ“‰ Monthly Report</button>
            <button class="btn btn-success" onclick="exportToCSV()">ðŸ“¥ Export as CSV</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function exportReport(period) {
      alert(`Exporting ${period} report...`);
      // In a real app, this would generate and download the report
    }

    function exportToCSV() {
      alert('Exporting to CSV...');
      // In a real app, this would generate a CSV file
    }
  </script>
</body>
</html>
